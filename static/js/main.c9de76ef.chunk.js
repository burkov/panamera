(this.webpackJsonppanamera=this.webpackJsonppanamera||[]).push([[0],{133:function(e,t){},234:function(e,t,r){e.exports={verticalLine:"creds-prompt_verticalLine__Tx2pu"}},235:function(e,t,r){e.exports={linkButton:"link-button_linkButton__2xyCc"}},236:function(e,t,r){e.exports={errorDiv:"error-div_errorDiv__1C-Yp"}},242:function(e,t,r){e.exports={allTheSameRow:"params-table_allTheSameRow__1KWMe"}},250:function(e,t,r){},62:function(e,t,r){e.exports={wideDiv:"page_wideDiv__2inSG",pageContainer:"page_pageContainer__sagIe",contentWrapper:"page_contentWrapper__3aSSW",footer:"page_footer__3hx7W",branch:"page_branch__1t1gv"}},878:function(e,t,r){"use strict";r.r(t);var n=r(4),a=r(3),c=r.n(a),s=r(225),i=r.n(s),l=r(44),o=r.n(l),d=r(226),j=r.n(d),u=(r(249),r(250),r(251),r(8)),p=(r(879),r(881)),f=r(24),b=r(62),h=r.n(b),v=function(e){var t=e.children,r={branch:"main",tags:[],commit:{shortHash:"68253de",hash:"68253dee40232e3f6328ce07a62c479fd1207818",date:"2021-01-06T16:43:00+03:00",message:"fixes"}},a=r.branch,c=r.commit,s=c.date,i=c.shortHash,l=c.message;return Object(n.jsxs)("div",{className:h.a.pageContainer,children:[Object(n.jsxs)("div",{className:h.a.contentWrapper,children:[Object(n.jsx)(f.e,{children:Object(n.jsx)("h1",{className:"wt-h1",children:"Panamera: parameter naming errors resolution assistant"})}),Object(n.jsx)(f.c,{className:"wt-offset-top-24",children:t})]}),Object(n.jsxs)(f.d,{className:h.a.footer,children:[Object(n.jsx)(f.b,{}),Object(n.jsxs)("p",{className:"wt-text-3",children:[i," | ",Object(n.jsx)("span",{className:h.a.branch,children:a})," | built ",o()(s).fromNow()," | ",l]})]})]})},m=r(234),x=r.n(m),O=r(18),w=r.n(O),g=r(47),_=r(142),y=r(243),N=r(5),k=r.n(N),S=r(235),C=r.n(S),P=function(e){var t=e.children,r=Object(y.a)(e,["children"]);return Object(n.jsx)("button",Object(_.a)(Object(_.a)({},r),{},{className:k()("wt-link",C.a.linkButton),children:t}))},F=r(236),K=r.n(F),B=function(e){var t=e.className,r=e.error;return r?Object(n.jsxs)("div",{className:k()(K.a.errorDiv,"wt-text-2",t),children:["Error: ",r.message]}):null},D=r(237),M=r.n(D),W=r(95),E=r(140),R=function(e){return e.split("").map((function(t,r){return r<6||r>e.length-4?t:"*"})).join("")},V=function(e,t){try{var r=e();r instanceof Promise&&r.catch(t)}catch(n){t(n)}},z=function(){var e=Object(g.a)(w.a.mark((function e(){var t,r,n,a,c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker({multiple:!1});case 2:return t=e.sent,r=Object(u.a)(t,1),n=r[0],e.next=7,n.getFile();case 7:if("credentials"===(a=e.sent).name){e.next=10;break}throw new Error("File should be named 'credentials'");case 10:return e.t0=M.a,e.next=13,a.text();case 13:return e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),s=W.a().shape({aws_access_key_id:W.b().required(),aws_secret_access_key:W.b().required()}),e.abrupt("return",Object.entries(c).filter((function(e){var t=Object(u.a)(e,2)[1];return s.isValidSync(t)})).map((function(e){var t=Object(u.a)(e,2),r=t[0],n=t[1];return[r,{accessKey:n.aws_access_key_id,secretKey:n.aws_secret_access_key}]})));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(e){var t=e.onCredentialsSelected,r=Object(a.useState)(),c=Object(u.a)(r,2),s=c[0],i=c[1],l=Object(a.useState)(),o=Object(u.a)(l,2),d=o[0],j=o[1];Object(a.useEffect)((function(){d&&1===d.length&&t(d[0][1])}),[d,t]);var p=function(){var e=Object(g.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(void 0),V(Object(g.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=j,e.next=3,z();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))),i);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return d?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h4",{className:"wt-h4",children:"Select profile to use:"}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),Object(n.jsx)(E.a,{size:"xs",children:d.map((function(e){var r=Object(u.a)(e,2),a=r[0],c=r[1];return Object(n.jsxs)(E.b,{onClick:function(){return t(c)},children:[a," (",R(c.accessKey),")"]},a)}))})]}):Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"wt-text-2",children:[Object(n.jsx)(P,{onClick:p,children:"Import"})," credentials from ",Object(n.jsx)("strong",{children:"~/.aws/credentials"}),Object(n.jsx)(B,{className:"wt-offset-top-12",error:s})]})})},T=function(e){var t=e.onCredentialsSelected;return Object(n.jsx)(v,{children:Object(n.jsxs)(f.f,{children:[Object(n.jsx)(f.a,{span:4,children:Object(n.jsx)(A,{onCredentialsSelected:t})}),Object(n.jsx)(f.a,{span:"inline",children:Object(n.jsx)("div",{className:x.a.verticalLine})}),Object(n.jsx)(f.a,{span:"inline",children:Object(n.jsxs)("ul",{className:"wt-ul",children:[Object(n.jsx)("li",{children:"Keys will be used for read-only operations"}),Object(n.jsx)("li",{children:"Keys will be stored in browser local storage"}),Object(n.jsx)("li",{children:"Keys will be used only from this webapp, they are not transferred anywhere"}),Object(n.jsx)("li",{children:"You can remove them anytime you want later by clicking 'Sign out' link"})]})})]})})},I=r(13),L=r(138),Y=r.n(L),q=r(880),G=r(141),H=r(242),J=r.n(H),U=r(94),Q=r.n(U),X=r(139),Z=["dev1","dev2","dev3","dev4","dev5","audt","stgn/blue","stgn/green"],$=function(e,t){return t.length>e?t.slice(0,e)+"...":t},ee=[X.a,"#9cf55e","#adee98","#f5db8d","#f3c05b",X.b,"#d3a301"],te=function(e){var t=e.paramsForName;if(1===new Set(t.map((function(e){return e.Value}))).size)return Object(n.jsx)("td",{colSpan:Z.length,className:J.a.allTheSameRow,children:$(64,t[0].Value)});var r=new Map(Q.a.reverse(Q.a.sortBy(Object.entries(Q.a.countBy(t,"Value")),[function(e){return e[1]}])).map((function(e,t){return[Object(u.a)(e,1)[0],ee[t]]})));return console.log(r),Object(n.jsx)(n.Fragment,{children:Z.map((function(e){var a,c,s=t.filter((function(t){return t.Name.includes(e)}));return Object(n.jsx)("td",{width:100,style:{backgroundColor:0===s.length?"#ea6060":r.get(null!==(a=null===(c=s[0])||void 0===c?void 0:c.Value)&&void 0!==a?a:"fixme")},children:Object(n.jsx)("pre",{children:s.length>0?s.map((function(e,t,r){var n=e.Value,a=e.prefix;return r.length>1?"".concat(a.slice(a.lastIndexOf("/")+1).replace("lservice","ls").replace("allapps","all"),": ").concat($(32,n)):$(32,n)})).join("\n"):"<missing>"})},"".concat(e,"-value"))}))})},re=function(e){var t=e.params,r=Object(a.useMemo)((function(){var e=new Set,r=new Map;return t.forEach((function(t){var n;e.add(t.prefix);var a=t.Name.slice(t.prefix.length),c=null!==(n=r.get(a))&&void 0!==n?n:[];r.set(a,[].concat(Object(I.a)(c),[t]))})),Array.from(r.entries()).sort()}),[t]);return Object(n.jsxs)("table",{className:"wt-table wt-table_wide wt-table_size_xs",children:[Object(n.jsx)("thead",{className:"wt-text-3",children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),Z.map((function(e){return Object(n.jsx)("th",{children:e},e)}))]})}),Object(n.jsx)("tbody",{className:"wt-text-3",children:r.map((function(e){var t=Object(u.a)(e,2),r=t[0],a=t[1];return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{width:400,children:r}),Object(n.jsx)(te,{paramsForName:a})]})}))})]})},ne=[{tomcat:"/jetprofile-dev1/",lservice:"/jetprofile/dev1/lservice",allapps:"/jetprofile/dev1/allapps"},{tomcat:"/jetprofile-dev2/",lservice:"/jetprofile/dev2/lservice",allapps:"/jetprofile/dev2/allapps"},{tomcat:"/jetprofile-dev3/",lservice:"/jetprofile/dev3/lservice",allapps:"/jetprofile/dev3/allapps"},{tomcat:"/jetprofile-dev4/",lservice:"/jetprofile/dev4/lservice",allapps:"/jetprofile/dev4/allapps"},{tomcat:"/jetprofile-dev5/",lservice:"/jetprofile/dev5/lservice",allapps:"/jetprofile/dev5/allapps"},{tomcat:"/jetprofile-audt/",lservice:"/jetprofile/audt/lservice",allapps:"/jetprofile/audt/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/blue/lservice",allapps:"/jetprofile/stgn/blue/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/green/lservice",allapps:"/jetprofile/stgn/green/allapps"}],ae=function(e){var t=e.credentials,r=e.removeCredentials,c=t.accessKey,s=t.secretKey,i=Object(a.useState)(),l=Object(u.a)(i,2),d=l[0],j=l[1],f=Object(a.useState)([]),b=Object(u.a)(f,2),h=b[0],m=b[1],x=new Y.a.SSM({region:"eu-west-1",credentials:new L.Credentials(c,s)}),O=function(){var e=Object(p.a)("aws-params",{parameters:[],fetchedAt:void 0}),t=Object(u.a)(e,3),r=t[0],n=t[1];return[r,function(e){n({fetchedAt:new Date,parameters:e})},t[2]]}(),_=Object(u.a)(O,3),y=_[0],N=y.fetchedAt,k=y.parameters,S=_[1],C=_[2];Object(q.a)((function(){}));var P=function(){var e=Object(g.a)(w.a.mark((function e(){var t,r,n,a,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=new Set(ne.flatMap((function(e){var t=e.tomcat,r=e.allapps;return[t,e.lservice,r]}))),m([]),n=w.a.mark((function e(){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c[a],console.log(r),e.next=4,new Promise((function(e){var n=1;x.getParametersByPath({Path:r,Recursive:!0,WithDecryption:!0}).eachPage((function(a,c,s){return j("prefix '".concat(r,"' page ").concat(n," (total: ").concat(t.length,")")),a&&m((function(e){return[].concat(Object(I.a)(e),[a])})),(null===s||void 0===s?void 0:s())||((null===c||void 0===c?void 0:c.Parameters)&&t.push.apply(t,Object(I.a)(null===c||void 0===c?void 0:c.Parameters.map((function(e){return e.prefix=r,e})))),n++),null==c&&e(void 0),!0}))}));case 4:case"end":return e.stop()}}),e)})),a=0,c=Array.from(r);case 5:if(!(a<c.length)){e.next=10;break}return e.delegateYield(n(),"t0",7);case 7:a++,e.next=5;break;case 10:S(t),j(void 0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(v,{children:[Object(n.jsxs)("div",{className:"wt-text-2",children:["Using key: ",Object(n.jsx)("strong",{children:R(c)})," | Fetched ",Object(n.jsx)("strong",{children:null===k||void 0===k?void 0:k.length})," parameters ",Object(n.jsx)("strong",{children:N?o()(N).fromNow():""})," |"," ",Object(n.jsx)(G.a,{size:"xs",mode:"nude",onClick:P,children:"Refresh"})," ","|"," ",Object(n.jsx)(G.a,{size:"xs",mode:"nude",onClick:function(){r(),C()},children:"Sign out"})]}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),h.length>0&&Object(n.jsx)(B,{error:new Error("Got ".concat(h.length," unexpected error while refreshing params"))}),void 0===d&&0===(null===k||void 0===k?void 0:k.length)&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Parameters table is empty, press ",Object(n.jsx)("strong",{children:"Refresh"})," above to fill it"]}),d&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Loading ",d,"..."]}),!d&&k.length>0&&Object(n.jsx)(re,{params:k})]})},ce=function(){var e=Object(p.a)("aws-credentials"),t=Object(u.a)(e,3),r=t[0],a=t[1],c=t[2];return void 0===r?Object(n.jsx)(T,{onCredentialsSelected:a}):Object(n.jsx)(ae,{credentials:r,removeCredentials:c})};o.a.extend(j.a),i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(ce,{})}),document.getElementById("root"))}},[[878,1,2]]]);
//# sourceMappingURL=main.c9de76ef.chunk.js.map