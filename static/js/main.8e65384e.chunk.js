(this.webpackJsonppanamera=this.webpackJsonppanamera||[]).push([[0],{133:function(e,t){},235:function(e,t,r){e.exports={verticalLine:"creds-prompt_verticalLine__Tx2pu"}},236:function(e,t,r){e.exports={linkButton:"link-button_linkButton__2xyCc"}},237:function(e,t,r){e.exports={errorDiv:"error-div_errorDiv__1C-Yp"}},243:function(e,t,r){e.exports={allTheSameRow:"params-table_allTheSameRow__1KWMe"}},251:function(e,t,r){},62:function(e,t,r){e.exports={pageContainer:"page_pageContainer__sagIe",contentWrapper:"page_contentWrapper__3aSSW",footer:"page_footer__3hx7W",branch:"page_branch__1t1gv"}},879:function(e,t,r){"use strict";r.r(t);var n=r(4),a=r(3),c=r.n(a),s=r(225),i=r.n(s),l=r(44),o=r.n(l),j=r(226),d=r.n(j),u=(r(250),r(251),r(252),r(8)),p=r(227),b=(r(880),r(882)),f=r(21),h=r(235),v=r.n(h),m=r(18),x=r.n(m),O=r(47),w=r(142),g=r(244),_=r(5),y=r.n(_),N=r(236),k=r.n(N),S=function(e){var t=e.children,r=Object(g.a)(e,["children"]);return Object(n.jsx)("button",Object(w.a)(Object(w.a)({},r),{},{className:y()("wt-link",k.a.linkButton),children:t}))},C=r(237),P=r.n(C),F=function(e){var t=e.className,r=e.error;return r?Object(n.jsxs)("div",{className:y()(P.a.errorDiv,"wt-text-2",t),children:["Error: ",r.message]}):null},K=r(238),B=r.n(K),M=r(95),W=r(140),E=function(e){return e.split("").map((function(t,r){return r<6||r>e.length-4?t:"*"})).join("")},R=function(e,t){try{var r=e();r instanceof Promise&&r.catch(t)}catch(n){t(n)}},V=function(){var e=Object(O.a)(x.a.mark((function e(){var t,r,n,a,c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker({multiple:!1});case 2:return t=e.sent,r=Object(u.a)(t,1),n=r[0],e.next=7,n.getFile();case 7:if("credentials"===(a=e.sent).name){e.next=10;break}throw new Error("File should be named 'credentials'");case 10:return e.t0=B.a,e.next=13,a.text();case 13:return e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),s=M.a().shape({aws_access_key_id:M.b().required(),aws_secret_access_key:M.b().required()}),e.abrupt("return",Object.entries(c).filter((function(e){var t=Object(u.a)(e,2)[1];return s.isValidSync(t)})).map((function(e){var t=Object(u.a)(e,2),r=t[0],n=t[1];return[r,{accessKey:n.aws_access_key_id,secretKey:n.aws_secret_access_key}]})));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(e){var t=e.onCredentialsSelected,r=Object(a.useState)(),c=Object(u.a)(r,2),s=c[0],i=c[1],l=Object(a.useState)(),o=Object(u.a)(l,2),j=o[0],d=o[1];Object(a.useEffect)((function(){j&&1===j.length&&t(j[0][1])}),[j,t]);var p=function(){var e=Object(O.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(void 0),R(Object(O.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,V();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))),i);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return j?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h4",{className:"wt-h4",children:"Select profile to use:"}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),Object(n.jsx)(W.a,{size:"xs",children:j.map((function(e){var r=Object(u.a)(e,2),a=r[0],c=r[1];return Object(n.jsxs)(W.b,{onClick:function(){return t(c)},children:[a," (",E(c.accessKey),")"]},a)}))})]}):Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"wt-text-2",children:[Object(n.jsx)(S,{onClick:p,children:"Import"})," credentials from ",Object(n.jsx)("strong",{children:"~/.aws/credentials"}),Object(n.jsx)(F,{className:"wt-offset-top-12",error:s})]})})},A=function(e){var t=e.onCredentialsSelected;return Object(n.jsxs)(f.g,{children:[Object(n.jsx)(f.a,{span:4,children:Object(n.jsx)(z,{onCredentialsSelected:t})}),Object(n.jsx)(f.a,{span:"inline",children:Object(n.jsx)("div",{className:v.a.verticalLine})}),Object(n.jsx)(f.a,{span:"inline",children:Object(n.jsxs)("ul",{className:"wt-ul",children:[Object(n.jsx)("li",{children:"Keys will be used for read-only operations"}),Object(n.jsx)("li",{children:"Keys will be stored in browser local storage"}),Object(n.jsx)("li",{children:"Keys will be used only from this webapp, they are not transferred anywhere"}),Object(n.jsx)("li",{children:"You can remove them anytime you want later by clicking 'Sign out' link"})]})})]})},D=r(13),T=r(138),I=r.n(T),L=r(881),Y=r(141),q=r(243),H=r.n(q),J=r(94),G=r.n(J),U=r(139),Q=["dev1","dev2","dev3","dev4","dev5","audt","stgn/blue","stgn/green"],X=function(e,t){return t.length>e?t.slice(0,e)+"...":t},Z=[U.a,"#9cf55e","#adee98","#f5db8d","#f3c05b",U.b,"#d3a301"],$=function(e){var t=e.paramsForName;if(1===new Set(t.map((function(e){return e.Value}))).size)return Object(n.jsx)("td",{colSpan:Q.length,className:H.a.allTheSameRow,children:X(64,t[0].Value)});var r=new Map(G.a.reverse(G.a.sortBy(Object.entries(G.a.countBy(t,"Value")),[function(e){return e[1]}])).map((function(e,t){return[Object(u.a)(e,1)[0],Z[t]]})));return console.log(r),Object(n.jsx)(n.Fragment,{children:Q.map((function(e){var a,c,s=t.filter((function(t){return t.Name.includes(e)}));return Object(n.jsx)("td",{width:100,style:{backgroundColor:0===s.length?"#ea6060":r.get(null!==(a=null===(c=s[0])||void 0===c?void 0:c.Value)&&void 0!==a?a:"fixme")},children:Object(n.jsx)("pre",{children:s.length>0?s.map((function(e,t,r){var n=e.Value,a=e.prefix;return r.length>1?"".concat(a.slice(a.lastIndexOf("/")+1).replace("lservice","ls").replace("allapps","all"),": ").concat(X(32,n)):X(32,n)})).join("\n"):"<missing>"})},"".concat(e,"-value"))}))})},ee=function(e){var t=e.params,r=Object(a.useMemo)((function(){var e=new Set,r=new Map;return t.forEach((function(t){var n;e.add(t.prefix);var a=t.Name.slice(t.prefix.length),c=null!==(n=r.get(a))&&void 0!==n?n:[];r.set(a,[].concat(Object(D.a)(c),[t]))})),Array.from(r.entries()).sort()}),[t]);return Object(n.jsxs)("table",{className:"wt-table wt-table_wide wt-table_size_xs",children:[Object(n.jsx)("thead",{className:"wt-text-3",children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),Q.map((function(e){return Object(n.jsx)("th",{children:e},e)}))]})}),Object(n.jsx)("tbody",{className:"wt-text-3",children:r.map((function(e){var t=Object(u.a)(e,2),r=t[0],a=t[1];return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{width:400,children:r}),Object(n.jsx)($,{paramsForName:a})]})}))})]})},te=[{tomcat:"/jetprofile-dev1/",lservice:"/jetprofile/dev1/lservice",allapps:"/jetprofile/dev1/allapps"},{tomcat:"/jetprofile-dev2/",lservice:"/jetprofile/dev2/lservice",allapps:"/jetprofile/dev2/allapps"},{tomcat:"/jetprofile-dev3/",lservice:"/jetprofile/dev3/lservice",allapps:"/jetprofile/dev3/allapps"},{tomcat:"/jetprofile-dev4/",lservice:"/jetprofile/dev4/lservice",allapps:"/jetprofile/dev4/allapps"},{tomcat:"/jetprofile-dev5/",lservice:"/jetprofile/dev5/lservice",allapps:"/jetprofile/dev5/allapps"},{tomcat:"/jetprofile-audt/",lservice:"/jetprofile/audt/lservice",allapps:"/jetprofile/audt/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/blue/lservice",allapps:"/jetprofile/stgn/blue/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/green/lservice",allapps:"/jetprofile/stgn/green/allapps"}],re=function(e){var t=e.credentials,r=e.removeCredentials,c=t.accessKey,s=t.secretKey,i=Object(a.useState)(),l=Object(u.a)(i,2),j=l[0],d=l[1],p=Object(a.useState)([]),f=Object(u.a)(p,2),h=f[0],v=f[1],m=new I.a.SSM({region:"eu-west-1",credentials:new T.Credentials(c,s)}),w=function(){var e=Object(b.a)("aws-params",{parameters:[],fetchedAt:void 0}),t=Object(u.a)(e,3),r=t[0],n=t[1];return[r,function(e){n({fetchedAt:new Date,parameters:e})},t[2]]}(),g=Object(u.a)(w,3),_=g[0],y=_.fetchedAt,N=_.parameters,k=g[1],S=g[2];Object(L.a)((function(){}));var C=function(){var e=Object(O.a)(x.a.mark((function e(){var t,r,n,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=new Set(te.flatMap((function(e){var t=e.tomcat,r=e.allapps;return[t,e.lservice,r]}))),v([]),n=x.a.mark((function e(){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c[a],console.log(r),e.next=4,new Promise((function(e){var n=1;m.getParametersByPath({Path:r,Recursive:!0,WithDecryption:!0}).eachPage((function(a,c,s){return d("prefix '".concat(r,"' page ").concat(n," (total: ").concat(t.length,")")),a&&v((function(e){return[].concat(Object(D.a)(e),[a])})),(null===s||void 0===s?void 0:s())||((null===c||void 0===c?void 0:c.Parameters)&&t.push.apply(t,Object(D.a)(null===c||void 0===c?void 0:c.Parameters.map((function(e){return e.prefix=r,e})))),n++),null==c&&e(void 0),!0}))}));case 4:case"end":return e.stop()}}),e)})),a=0,c=Array.from(r);case 5:if(!(a<c.length)){e.next=10;break}return e.delegateYield(n(),"t0",7);case 7:a++,e.next=5;break;case 10:k(t),d(void 0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"wt-text-2",children:["Using key: ",Object(n.jsx)("strong",{children:E(c)})," | Fetched ",Object(n.jsx)("strong",{children:null===N||void 0===N?void 0:N.length})," parameters ",Object(n.jsx)("strong",{children:y?o()(y).fromNow():""})," |"," ",Object(n.jsx)(Y.a,{size:"xs",mode:"nude",onClick:C,children:"Refresh"})," ","|"," ",Object(n.jsx)(Y.a,{size:"xs",mode:"nude",onClick:function(){r(),S()},children:"Sign out"})]}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),h.length>0&&Object(n.jsx)(F,{error:new Error("Got ".concat(h.length," unexpected error while refreshing params"))}),void 0===j&&0===(null===N||void 0===N?void 0:N.length)&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Parameters table is empty, press ",Object(n.jsx)("strong",{children:"Refresh"})," above to fill it"]}),j&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Loading ",j,"..."]}),!j&&Object(n.jsx)(ee,{params:N})]})},ne=r(62),ae=r.n(ne),ce=function(e){var t=e.children,r={branch:"main",tags:[],commit:{shortHash:"8652598",hash:"8652598af4bad4ea5baececac4fc9d8ac8befbc9",date:"2020-12-28T02:26:37+03:00",message:"Prototype done"}},a=r.branch,c=r.commit,s=c.date,i=c.shortHash,l=c.message;return Object(n.jsxs)(f.b,{className:ae.a.pageContainer,children:[Object(n.jsxs)("div",{className:ae.a.contentWrapper,children:[Object(n.jsx)(f.f,{children:Object(n.jsx)("h1",{className:"wt-h1",children:"Panamera: parameter naming errors resolution assistant"})}),Object(n.jsx)(f.d,{className:"wt-offset-top-24",children:t})]}),Object(n.jsxs)(f.e,{className:ae.a.footer,children:[Object(n.jsx)(f.c,{}),Object(n.jsxs)("p",{className:"wt-text-3",children:[i," | ",Object(n.jsx)("span",{className:ae.a.branch,children:a})," | built ",o()(s).fromNow()," | ",l]})]})]})},se=function(e){Object(p.a)(e);var t=Object(b.a)("aws-credentials"),r=Object(u.a)(t,3),a=r[0],c=r[1],s=r[2];return Object(n.jsx)(ce,{children:void 0===a?Object(n.jsx)(A,{onCredentialsSelected:c}):Object(n.jsx)(re,{credentials:a,removeCredentials:s})})};o.a.extend(d.a),i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(se,{})}),document.getElementById("root"))}},[[879,1,2]]]);
//# sourceMappingURL=main.8e65384e.chunk.js.map