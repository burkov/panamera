(this.webpackJsonppanamera=this.webpackJsonppanamera||[]).push([[0],{143:function(e,t){},244:function(e,t,r){e.exports={verticalLine:"creds-prompt_verticalLine__Tx2pu"}},245:function(e,t,r){e.exports={linkButton:"link-button_linkButton__2xyCc"}},246:function(e,t,r){e.exports={errorDiv:"error-div_errorDiv__1C-Yp"}},253:function(e,t,r){e.exports={allTheSameRow:"params-table_allTheSameRow__2SPTF"}},261:function(e,t,r){},70:function(e,t,r){e.exports={wideDiv:"page_wideDiv__2inSG",pageContainer:"page_pageContainer__sagIe",contentWrapper:"page_contentWrapper__3aSSW",footer:"page_footer__3hx7W",branch:"page_branch__1t1gv"}},891:function(e,t,r){"use strict";r.r(t);var n=r(3),a=r(0),c=r.n(a),s=r(236),i=r.n(s),l=r(51),o=r.n(l),u=r(237),d=r.n(u),j=(r(260),r(261),r(262),r(892),r(29)),p=r(244),f=r.n(p),b=r(16),h=r.n(b),v=r(12),m=r(40),x=r(54),O=r(102),g=r(5),w=r.n(g),y=r(245),_=r.n(y),N=function(e){var t=e.children,r=Object(O.a)(e,["children"]);return Object(n.jsx)("button",Object(x.a)(Object(x.a)({},r),{},{className:w()("wt-link",_.a.linkButton),children:t}))},S=r(246),k=r.n(S),C=function(e){var t=e.className,r=e.error;return r?Object(n.jsxs)("div",{className:w()(k.a.errorDiv,"wt-text-2",t),children:["Error: ",r.message]}):null},P=r(247),F=r.n(P),V=r(104),K=r(152),D=function(e){return e.split("").map((function(t,r){return r<6||r>e.length-4?t:"*"})).join("")},I=function(e,t){try{var r=e();r instanceof Promise&&r.catch(t)}catch(n){t(n)}},B=function(){var e=Object(m.a)(h.a.mark((function e(){var t,r,n,a,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker({multiple:!1});case 2:return t=e.sent,r=Object(v.a)(t,1),n=r[0],e.next=7,n.getFile();case 7:if("credentials"===(a=e.sent).name){e.next=10;break}throw new Error("File should be named 'credentials'");case 10:return e.t0=F.a,e.next=13,a.text();case 13:return e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),s=V.a().shape({aws_access_key_id:V.b().required(),aws_secret_access_key:V.b().required()}),e.abrupt("return",Object.entries(c).filter((function(e){var t=Object(v.a)(e,2)[1];return s.isValidSync(t)})).map((function(e){var t=Object(v.a)(e,2),r=t[0],n=t[1];return[r,{accessKey:n.aws_access_key_id,secretKey:n.aws_secret_access_key}]})));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){var t=e.onCredentialsSelected,r=Object(a.useState)(),c=Object(v.a)(r,2),s=c[0],i=c[1],l=Object(a.useState)(),o=Object(v.a)(l,2),u=o[0],d=o[1];Object(a.useEffect)((function(){u&&1===u.length&&t(u[0][1])}),[u,t]);var j=function(){var e=Object(m.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(void 0),I(Object(m.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,B();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))),i);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h4",{className:"wt-h4",children:"Select profile to use:"}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),Object(n.jsx)(K.a,{size:"xs",children:u.map((function(e){var r=Object(v.a)(e,2),a=r[0],c=r[1];return Object(n.jsxs)(K.b,{onClick:function(){return t(c)},children:[a," (",D(c.accessKey),")"]},a)}))})]}):Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"wt-text-2",children:[Object(n.jsx)(N,{onClick:j,children:"Import"})," credentials from ",Object(n.jsx)("strong",{children:"~/.aws/credentials"}),Object(n.jsx)(C,{className:"wt-offset-top-12",error:s})]})})},R=r(254),M=function(e){try{var t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(r){return console.error("Failed to read value from local storage",r),void localStorage.removeItem(e)}},T=function(){var e=Object(m.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(e){var t=Object(R.a)(e,T,{initialData:M(e)}),r=t.data,n=t.mutate;return{value:r,setValue:function(t){localStorage.setItem(e,JSON.stringify(t)),n(t).catch(console.error)},removeValue:function(){localStorage.removeItem(e),n(void 0).catch(console.error)}}},z=function(){var e=W("aws-credentials");return{credentials:e.value,setCredentials:e.setValue,removeCredentials:e.removeValue}},A=r(9),J=function(){var e,t,r=z(),c=r.credentials,s=r.setCredentials,i=Object(A.g)(),l=Object(A.h)(),o=null!==(e=null===l||void 0===l||null===(t=l.state)||void 0===t?void 0:t.from)&&void 0!==e?e:"/";return Object(a.useEffect)((function(){void 0!==c&&i.push(o)}),[c,i,o]),Object(n.jsxs)(j.f,{children:[Object(n.jsx)(j.a,{span:4,children:Object(n.jsx)(E,{onCredentialsSelected:function(e){s(e),i.push(o)}})}),Object(n.jsx)(j.a,{span:"inline",children:Object(n.jsx)("div",{className:f.a.verticalLine})}),Object(n.jsx)(j.a,{span:"inline",children:Object(n.jsxs)("ul",{className:"wt-ul",children:[Object(n.jsx)("li",{children:"Keys will be used for read-only operations"}),Object(n.jsx)("li",{children:"Keys will be stored in browser local storage"}),Object(n.jsx)("li",{children:"Keys will be used only from this webapp, they are not transferred anywhere"}),Object(n.jsx)("li",{children:"You can remove them anytime you want later by clicking 'Sign out' link"})]})})]})},L=function(e){var t=e.children,r=Object(O.a)(e,["children"]),a=z().credentials;return Object(n.jsx)(A.b,Object(x.a)(Object(x.a)({},r),{},{children:function(e){var r=e.location;return void 0===a?Object(n.jsx)(A.a,{to:{pathname:"/credentials",state:{from:r}}}):t}}))},Y=r(70),q=r.n(Y),G=function(e){var t=e.children,r={branch:"main",tags:[],commit:{shortHash:"20d6725",hash:"20d6725395fc79f944e6b802b774026226e51dd3",date:"2021-01-06T20:55:28+03:00",message:"Remove react-use"}},a=r.branch,c=r.commit,s=c.date,i=c.shortHash,l=c.message;return Object(n.jsxs)("div",{className:q.a.pageContainer,children:[Object(n.jsxs)("div",{className:q.a.contentWrapper,children:[Object(n.jsx)(j.e,{children:Object(n.jsx)("h1",{className:"wt-h1",children:"Panamera: parameter naming errors resolution assistant"})}),Object(n.jsx)(j.c,{className:"wt-offset-top-24",children:t})]}),Object(n.jsxs)(j.d,{className:q.a.footer,children:[Object(n.jsx)(j.b,{}),Object(n.jsxs)("p",{className:"wt-text-3",children:[i," | ",Object(n.jsx)("span",{className:q.a.branch,children:a})," | built ",o()(s).fromNow()," | ",l]})]})]})},H=r(15),U=r(150),Q=r.n(U),X=r(153),Z=r(253),$=r.n(Z),ee=r(103),te=r.n(ee),re=r(151),ne=["dev1","dev2","dev3","dev4","dev5","audt","stgn/blue","stgn/green"],ae=function(e,t){return t.length>e?t.slice(0,e)+"...":t},ce=[re.a,"#9cf55e","#adee98","#f5db8d","#f3c05b",re.b,"#d3a301"],se=function(e){var t=e.paramsForName;if(1===new Set(t.map((function(e){return e.Value}))).size)return Object(n.jsx)("td",{colSpan:ne.length,className:$.a.allTheSameRow,children:ae(64,t[0].Value)});var r=new Map(te.a.reverse(te.a.sortBy(Object.entries(te.a.countBy(t,"Value")),[function(e){return e[1]}])).map((function(e,t){return[Object(v.a)(e,1)[0],ce[t]]})));return Object(n.jsx)(n.Fragment,{children:ne.map((function(e){var a,c,s=t.filter((function(t){return t.Name.includes(e)}));return Object(n.jsx)("td",{width:100,style:{backgroundColor:0===s.length?"#ea6060":r.get(null!==(a=null===(c=s[0])||void 0===c?void 0:c.Value)&&void 0!==a?a:"fixme")},children:Object(n.jsx)("pre",{children:s.length>0?s.map((function(e,t,r){var n=e.Value,a=e.Prefix;return r.length>1?"".concat(a.slice(a.lastIndexOf("/")+1).replace("lservice","ls").replace("allapps","all"),": ").concat(ae(32,n)):ae(32,n)})).join("\n"):"<missing>"})},"".concat(e,"-value"))}))})},ie=function(e){var t=e.params,r=Object(a.useMemo)((function(){var e=new Set,r=new Map;return t.forEach((function(t){var n;e.add(t.Prefix);var a=t.Name.slice(t.Prefix.length),c=null!==(n=r.get(a))&&void 0!==n?n:[];r.set(a,[].concat(Object(H.a)(c),[t]))})),Array.from(r.entries()).sort()}),[t]);return Object(n.jsxs)("table",{className:"wt-table wt-table_wide wt-table_size_xs",children:[Object(n.jsx)("thead",{className:"wt-text-3",children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),ne.map((function(e){return Object(n.jsx)("th",{children:e},e)}))]})}),Object(n.jsx)("tbody",{className:"wt-text-3",children:r.map((function(e){var t=Object(v.a)(e,2),r=t[0],a=t[1];return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{width:400,children:r}),Object(n.jsx)(se,{paramsForName:a})]})}))})]})},le=[{tomcat:"/jetprofile-dev1/",lservice:"/jetprofile/dev1/lservice",allapps:"/jetprofile/dev1/allapps"},{tomcat:"/jetprofile-dev2/",lservice:"/jetprofile/dev2/lservice",allapps:"/jetprofile/dev2/allapps"},{tomcat:"/jetprofile-dev3/",lservice:"/jetprofile/dev3/lservice",allapps:"/jetprofile/dev3/allapps"},{tomcat:"/jetprofile-dev4/",lservice:"/jetprofile/dev4/lservice",allapps:"/jetprofile/dev4/allapps"},{tomcat:"/jetprofile-dev5/",lservice:"/jetprofile/dev5/lservice",allapps:"/jetprofile/dev5/allapps"},{tomcat:"/jetprofile-audt/",lservice:"/jetprofile/audt/lservice",allapps:"/jetprofile/audt/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/blue/lservice",allapps:"/jetprofile/stgn/blue/allapps"},{tomcat:"/jetprofile-stgn/",lservice:"/jetprofile/stgn/green/lservice",allapps:"/jetprofile/stgn/green/allapps"}],oe=function(){var e=z(),t=e.credentials,r=e.removeCredentials,c=null!==t&&void 0!==t?t:{accessKey:"",secretKey:""},s=c.accessKey,i=c.secretKey,l=Object(a.useState)(),u=Object(v.a)(l,2),d=u[0],j=u[1],p=Object(a.useState)([]),f=Object(v.a)(p,2),b=f[0],x=f[1],O=new Q.a.SSM({region:"eu-west-1",credentials:new U.Credentials(s,i)}),g=W("aws-params"),w=g.value,y=g.setValue,_=g.removeValue,N=null!==w&&void 0!==w?w:{fetchedAt:void 0,parameters:[]},S=N.fetchedAt,k=N.parameters,P=function(){var e=Object(m.a)(h.a.mark((function e(){var t,r,n,a,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=le.flatMap((function(e){var t=e.tomcat,r=e.allapps;return[t,e.lservice,r]})),n=new Set(r),x([]),a=h.a.mark((function e(){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s[c],e.next=3,new Promise((function(e){var n=1;O.getParametersByPath({Path:r,Recursive:!0,WithDecryption:!0}).eachPage((function(a,c,s){return j("prefix '".concat(r,"' page ").concat(n," (total: ").concat(t.length,")")),a&&x((function(e){return[].concat(Object(H.a)(e),[a])})),(null===s||void 0===s?void 0:s())||((null===c||void 0===c?void 0:c.Parameters)&&t.push.apply(t,Object(H.a)(null===c||void 0===c?void 0:c.Parameters.map((function(e){return e.Prefix=r,e})))),n++),null==c&&e(void 0),!0}))}));case 3:case"end":return e.stop()}}),e)})),c=0,s=Array.from(n);case 6:if(!(c<s.length)){e.next=11;break}return e.delegateYield(a(),"t0",8);case 8:c++,e.next=6;break;case 11:y({fetchedAt:new Date,parameters:t}),j(void 0);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"wt-text-2",children:["Using key: ",Object(n.jsx)("strong",{children:D(s)})," | Fetched ",Object(n.jsx)("strong",{children:null===k||void 0===k?void 0:k.length})," parameters ",Object(n.jsx)("strong",{children:S?o()(S).fromNow():""})," |"," ",Object(n.jsx)(X.a,{size:"xs",mode:"nude",onClick:P,children:"Refresh"})," ","|"," ",Object(n.jsx)(X.a,{size:"xs",mode:"nude",onClick:function(){r(),_()},children:"Sign out"})]}),Object(n.jsx)("div",{className:"wt-offset-top-12"}),b.length>0&&Object(n.jsx)(C,{error:new Error("Got ".concat(b.length," unexpected error while refreshing params"))}),void 0===d&&0===(null===k||void 0===k?void 0:k.length)&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Parameters table is empty, press ",Object(n.jsx)("strong",{children:"Refresh"})," above to fill it"]}),d&&Object(n.jsxs)("p",{className:"wt-text-2",children:["Loading ",d,"..."]}),!d&&k.length>0&&Object(n.jsx)(ie,{params:k})]})},ue=function(){return Object(n.jsx)(G,{children:Object(n.jsxs)(A.d,{children:[Object(n.jsx)(A.b,{path:"/credentials",children:Object(n.jsx)(J,{})}),Object(n.jsx)(L,{path:"/",exact:!0,children:Object(n.jsx)(oe,{})})]})})},de=r(66);o.a.extend(d.a),i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(de.a,{children:Object(n.jsx)(ue,{})})}),document.getElementById("root"))}},[[891,1,2]]]);
//# sourceMappingURL=main.ac1e7d3c.chunk.js.map